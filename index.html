<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EV Charger Stations and Growth Rate</title>
    <!-- Include Pure.css for styling -->
    <!-- <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.6/build/pure-min.css"> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <style>
        /* Additional styling */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .grid {
            display: flex;
            flex-wrap: wrap;
        }
        .grid-item {
            flex: 1;
            min-width: 500px;
            margin: 10px;
        }
        h1 {
            text-align: center;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>EV Charger Stations in Australia and Growth Rate</h1>
        
        <!-- Grid to hold both visualizations -->
        <div class="grid">
            <!-- Old Vega Map -->
            <div id="vega-map" class="grid-item"></div>
            
            <!-- New Vega Plot for Growth Rate -->
            <div id="vega-growth" class="grid-item"></div>
        </div>
    </div>

    <!-- Vega map (your old map) -->
    <script type="text/javascript">
        var vegaMapSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 800,
            "height": 500,
            "title": "EV Charger Stations in Australia 2024",
            "projection": {
                "type": "conicConformal",
                "rotate": [-133, 31, 0],
                "center": [0, 3],
                "scale": {"expr": "zoom * 720"}, // Zoom scale expression
                "translate": [{"signal": "tx"}, {"signal": "ty"}] // Panning translation
            },
            "params": [
                {
                "name": "zoom",  // Zoom control
                "value": 1,
                "bind": {
                    "input": "range",
                    "min": 1,
                    "max": 3,
                    "step": 0.1,
                    "name": "Zoom"
                }
                },
                {
                "name": "tx",  // X translation for panning
                "value": 400,
                "bind": {
                    "input": "range",
                    "min": -800,
                    "max": 1600,
                    "step": 10,
                    "name": "Pan X"
                }
                },
                {
                "name": "ty",  // Y translation for panning
                "value": 250,
                "bind": {
                    "input": "range",
                    "min": -500,
                    "max": 1000,
                    "step": 10,
                    "name": "Pan Y"
                }
                },
                {
                "name": "yearSelector",
                "value": 2010,
                "bind": {
                    "input": "range",
                    "min": 2010,
                    "max": 2024,
                    "step": 1
                }
                },
                {
                "name": "monthSelector",
                "value": 1,
                "bind": {
                    "input": "range",
                    "min": 1,
                    "max": 12,
                    "step": 1
                }
                },
                {
                "name": "showStateNames",
                "value": true,
                "bind": {
                    "input": "checkbox",
                    "name": "Show States"
                }
                },
                {
                "name": "showCityNames",
                "value": true,
                "bind": {
                    "input": "checkbox",
                    "name": "Show Cities"
                }
                }
            ],
            "layer": [
                {
                "data": {
                    "sphere": true
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#f5fbff"  // Light blue ocean
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/WA_simplified.geojson",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#D2B58F"
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/NT_simplified.geojson",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#B47557"
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/SA_simplified.geojson",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#CE9263"
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/QLD_simplified.geojson",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#A88E6A"
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/NSW_simplified.geojson",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#C7704B"
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/VIC_simplified.geojson",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#9B7357"
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/TAS_simplified.geojson",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#B37448",
                    "stroke": "#ffffff",
                    "strokeWidth": 1.5
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/ACT_simplified.geojson",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#e8cfae"
                }
                },
                // {
                //   "data": {
                //     "url": "https://nl1bs.github.io/Nl1bs/filtered_highways.geojson",
                //     "format": {"type": "json", "property": "features"}
                //   },
                //   "mark": {
                //     "type": "geoshape",
                //     "fill": null,
                //     // "stroke": "black",
                //     "strokeWidth": 2
                //   },
                //   "encoding": {
                //     // "longitude": {"field": "geometry.coordinates[0]", "type": "quantitative"},
                //     // "latitude": {"field": "geometry.coordinates[1]", "type": "quantitative"},
                //     // "detail": {"field": "properties.name", "type": "nominal"},
                //     "stroke": {
                //       "field": "properties.surface",
                //       "type": "nominal",
                //       "legend": {"title": "Surface Type", "symbolType": "stroke"}
                //     },
                //     "tooltip": [
                //       {"field": "properties.name", "type": "nominal", "title": "Road Name"},
                //       {"field": "properties.highway", "type": "nominal", "title": "Highway Type"},
                //       {"field": "properties.surface", "type": "nominal", "title": "Surface"}
                //     ]
                //   }
                // },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/Petrol_Stations_Clean.csv",
                    "format": {"type": "csv"}
                },
                "mark": {
                    "type": "point",
                    "opacity": 1.0,
                    "size": 10,
                    "fill": "white",
                    "stroke": "black",
                    "strokeWidth": 0.5
                },
                "encoding": {
                    "longitude": {"field": "X", "type": "quantitative"},
                    "latitude": {"field": "Y", "type": "quantitative"},
                    "tooltip": [
                    {"field": "N", "type": "nominal", "title": "Petrol Station Name"}
                    ]
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/australia_ev_chargers_clean.csv",
                    "format": {"type": "csv"}
                },
                "transform": [
                    {
                    "filter": "year(datum.DateCreated) <= yearSelector && (month(datum.DateCreated) <= monthSelector || year(datum.DateCreated) < yearSelector)"
                    }
                ],
                "mark": {
                    "type": "point",
                    "opacity": 1.0,
                    "size": 20,
                    "fill": "red",
                    "stroke": "black",
                    "strokeWidth": 0.5,
                    "tooltip": {"content": "data"}
                },
                "encoding": {
                    "longitude": {"field": "Longitude", "type": "quantitative"},
                    "latitude": {"field": "Latitude", "type": "quantitative"},
                    "tooltip": [
                    {"field": "Name", "type": "nominal", "title": "Name"},
                    {"field": "DateCreated", "type": "temporal", "title": "Date Created"},
                    {"field": "AveragePowerOutput", "type": "quantitative", "title": "Avg Power Output (kW)"}
                    ]
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/au_cities_small.csv",
                    "format": {"type": "csv"}
                },
                "transform": [
                    {
                    "filter": "showCityNames"
                    }
                ],
                "layer": [
                    {
                    "mark": {
                        "type": "point",
                        "opacity": 1.0,
                        "fill": "green",
                        "stroke": "black",
                        "strokeWidth": 0.5
                    },
                    "encoding": {
                        "longitude": {"field": "lng", "type": "quantitative"},
                        "latitude": {"field": "lat", "type": "quantitative"},
                        "size": {
                        "field": "population",
                        "type": "quantitative",
                        "scale": {"type": "log", "range": [50, 300]}  // Log scale for size, adjust the range for visualization
                        },
                        "tooltip": [
                        {"field": "city", "type": "nominal", "title": "City"},
                        {"field": "population", "type": "quantitative", "title": "Population"}
                        ]
                    }
                    },
                    {
                    "mark": {
                        "type": "text",
                        "dy": -15,  // Adjust the vertical position of the text
                        "fontSize": 15,
                        "color": "black"
                    },
                    "encoding": {
                        "longitude": {"field": "lng", "type": "quantitative"},
                        "latitude": {"field": "lat", "type": "quantitative"},
                        "text": {"field": "city", "type": "nominal"}  // Display city name
                    }
                    }
                ]
                },
                {
                "data": {
                    "values": [
                    {"state": "New South Wales", "lat": -31.2532, "lng": 146.9211},
                    {"state": "Victoria", "lat": -37.4713, "lng": 144.7852},
                    {"state": "Queensland", "lat": -20.9176, "lng": 142.7028},
                    {"state": "South Australia", "lat": -30.0002, "lng": 136.2092},
                    {"state": "Western Australia", "lat": -27.6728, "lng": 121.6283},
                    {"state": "Tasmania", "lat": -41.4545, "lng": 145.9707},
                    {"state": "Northern Territory", "lat": -19.4914, "lng": 132.5509}
                    ]
                },
                "transform": [
                    {
                    "filter": "showStateNames"
                    }
                ],
                "mark": {
                    "type": "text",
                    "fontSize": 12,
                    // "fontWeight": "bold",
                    "dy": -10,  // Slightly above the center
                    "color": "black"
                },
                "encoding": {
                    "longitude": {"field": "lng", "type": "quantitative"},
                    "latitude": {"field": "lat", "type": "quantitative"},
                    "text": {"field": "state", "type": "nominal"}  // Display city name
                }
                },
                {
                "data": {
                    "url": "https://nl1bs.github.io/Nl1bs/ne_110m_graticules_5.json",
                    "format": {"type": "json"}
                },
                "mark": {
                    "type": "geoshape",
                    "fill": null,  // No fill, just gridlines
                    "stroke": "#3d3d3d",  // Gray gridlines
                    "strokeWidth": 0.25
                }
                }
            ]         
        };
        vegaEmbed('#vega-map', vegaMapSpec);
    </script>

    <!-- Vega plot for rate of development (new plot) -->
    <script type="text/javascript">
        var growthRateSpec = {
          "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
          "title": "Rate of Development of EV Stations Over Time",
          "data": {
            "url": "ev_charger_development_over_time.csv",  // Preprocessed CSV data
            "format": {"type": "csv"}
          },
          "mark": {
            "type": "area",
            "interpolate": "monotone",
            "color": "#1f77b4"
          },
          "encoding": {
            "x": {
              "field": "Year",
              "type": "temporal",
              "axis": {"title": "Year"}
            },
            "y": {
              "field": "Cumulative EV Chargers",
              "type": "quantitative",
              "axis": {"title": "Cumulative EV Chargers"}
            }
          }
        };
        vegaEmbed('#vega-growth', growthRateSpec);
    </script>
</body>
</html>
